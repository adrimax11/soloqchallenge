---
import jugadores from './jugadores.json';
---

<script>
    const api = await import.meta.env.RIOT_API_KEY;

    const getSummoner = async (name) => {
        const response = await fetch(`https://euw1.api.riotgames.com/lol/summoner/v4/summoners/by-name/${name}?api_key=${api}`);
        const data = await response.json();
        return data;
    }

    const getElo = async (id) => {
        const response = await fetch(`https://euw1.api.riotgames.com/lol/league/v4/entries/by-summoner/${id}?api_key=${api}`);
        const data = await response.json();
        const soloQueueEntry = data.find((entry) => entry.queueType === 'RANKED_SOLO_5x5');
        if (soloQueueEntry) {
            return `${soloQueueEntry.tier} ${soloQueueEntry.rank} (${soloQueueEntry.leaguePoints} LP)`;
        } else {
            return 'Unranked';
        }
    }

    // Iterar sobre cada jugador en jugadores.json
    for (let jugador of jugadores) {
        // Obtener el nombre del invocador de la propiedad 'cuenta'
        const summonerName = jugador.cuenta;
        // Obtener los datos del invocador usando getSummoner
        const summonerData = await getSummoner(summonerName);
        // Obtener el id del invocador de los datos obtenidos
        const summonerId = summonerData.id;
        // Obtener el ELO del invocador usando getElo
        const elo = await getElo(summonerId);
        // Ahora puedes hacer algo con el ELO obtenido, por ejemplo, imprimirlo en la consola
        console.log(`ELO de ${summonerName}: ${elo}`);
    }
</script>
</div>